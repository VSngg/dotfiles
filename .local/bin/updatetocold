#!/bin/sh

footer() {
    echo "# Zettelkasten"
    echo ""
    echo "My personal knowledge base"
    echo ""
    echo "Last updated: $(isosec)"
    echo ""
    echo "## Table of Contents:"
    echo ""
}
rstrip() {
    # Usage: rstrip "string" "pattern"
    printf '%s\n' "${1%%$2}"
}
lstrip() {
    printf '%s\n' "${1##$2}"
}
gettitle() {
    for i in **/README.md; do
        DIRNAME=$(rstrip "$i" "/README.md")
        TITLE=$(lstrip "$(head -1 "$i")" "\# ")
        printf '* [%s](/%s/README.md) %s\n' "$DIRNAME" "$DIRNAME" "$TITLE"
    done 
}
alt() {
    for i in **/README.md; do
        DIRNAME=${i%%/README.md}
        title=$(head -1 "$i")
        TITLE=${ti##\# }
        echo $DIRNAME $TITLE
        printf '* [%s](/%s/README.md) %s\n' "$DIRNAME" "$DIRNAME" "$TITLE"
    done
}
main() {
    footer
    # gettitle
    alt
}

#main > README.md
main
